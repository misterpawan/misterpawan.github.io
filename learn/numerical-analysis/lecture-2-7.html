<!DOCTYPE html>
<html lang="en" class="scroll-smooth">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lecture 2-7: Random Numbers üé≤</title>

    <script src="https://cdn.tailwindcss.com"></script>

    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Pyodide -->
    <script src="https://cdn.jsdelivr.net/pyodide/v0.25.0/full/pyodide.js"></script>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>

    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-light.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        ntu: {
                            red: '#e11d48',
                            blue: '#1e3a8a',
                            light: '#eff6ff',
                            accent: '#f59e0b',
                        }
                    },
                    fontFamily: {
                        sans: ['Segoe UI', 'sans-serif'],
                        mono: ['Consolas', 'Monaco', 'monospace'],
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #f3f4f6;
            color: #1f2937;
        }

        .slide-card {
            background: white;
            border-radius: 12px;
            padding: 2.5rem;
            margin-bottom: 3rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            border: 1px solid #e5e7eb;
        }

        /* Editor & Output Styles matching Series 3 */
        .editor-container {
            position: relative;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            background: #ffffff;
            margin-bottom: 0.5rem;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .editor-wrapper {
            position: relative;
            min-height: 250px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.9rem;
            line-height: 1.5;
            background-color: #ffffff;
        }

        .editor-wrapper textarea,
        .editor-wrapper pre {
            margin: 0;
            padding: 1rem;
            border: none;
            width: 100%;
            height: 100%;
            box-sizing: border-box;
            white-space: pre;
            overflow: auto;
            position: absolute;
            top: 0;
            left: 0;
            font-family: inherit;
            font-size: inherit;
            line-height: inherit;
            tab-size: 4;
        }

        .editor-wrapper textarea {
            z-index: 2;
            color: transparent;
            background: transparent;
            caret-color: #000;
            resize: none;
            outline: none;
        }

        .editor-wrapper pre {
            z-index: 1;
            background: transparent;
            pointer-events: none;
        }

        .run-bar {
            background: #f1f5f9;
            padding: 0.5rem 1rem;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .run-btn {
            background: #e11d48;
            /* Red for Random */
            color: white;
            padding: 6px 16px;
            border-radius: 6px;
            font-size: 0.85rem;
            cursor: pointer;
            font-weight: 600;
            border: none;
            transition: background 0.2s;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .run-btn:hover {
            background: #be123c;
        }

        .run-btn:disabled {
            background: #94a3b8;
            cursor: not-allowed;
        }

        .output-box {
            margin-top: 0.5rem;
            background: #ffffff;
            color: #334155;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 1rem;
            font-family: 'Consolas', monospace;
            font-size: 0.85rem;
            min-height: 100px;
            max-height: 500px;
            overflow-y: auto;
            white-space: pre-wrap;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .output-img {
            max-width: 100%;
            border-radius: 4px;
            margin-top: 10px;
            border: 1px solid #e2e8f0;
        }

        .math-box {
            background: #fff1f2;
            /* Light Red tint */
            border-left: 4px solid #e11d48;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0 4px 4px 0;
            overflow-x: auto;
        }

        /* Teach Mode Styles */
        body.teach-mode {
            overflow: hidden;
            background: black;
        }

        body.teach-mode nav,
        body.teach-mode header,
        body.teach-mode footer {
            display: none !important;
        }

        body.teach-mode main {
            max-width: none;
            padding: 0;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        body.teach-mode .slide-card {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            margin: 0;
            border-radius: 0;
            padding: 4rem;
            z-index: 100;
            overflow-y: auto;
            align-content: center;
        }

        body.teach-mode .slide-card.active-slide {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: scale(0.98);
            }

            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .teach-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #e11d48;
            color: white;
            padding: 12px 24px;
            border-radius: 50px;
            font-weight: bold;
            box-shadow: 0 4px 12px rgba(225, 29, 72, 0.4);
            cursor: pointer;
            z-index: 9999;
            transition: transform 0.2s, box-shadow 0.2s;
            border: none;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .teach-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(225, 29, 72, 0.5);
        }

        body.teach-mode .teach-btn {
            display: none;
        }
    </style>
</head>

<body class="antialiased">

    <button onclick="toggleTeachMode()" class="teach-btn">
        <span>üë®‚Äçüè´</span> Teach Mode
    </button>

    <nav class="sticky top-0 z-50 bg-white/90 backdrop-blur-md border-b border-gray-200 shadow-sm">
        <div class="max-w-7xl mx-auto px-4 py-3 flex justify-between items-center">
            <span class="font-bold text-xl text-slate-800">Numerical Analysis <span
                    class="text-ntu-red">2-7</span></span>
            <div class="hidden md:flex space-x-1 text-sm font-medium text-slate-600">
                <a href="#intro" class="px-3 py-1 hover:bg-gray-100 rounded">Intro</a>
                <a href="#lcg" class="px-3 py-1 hover:bg-gray-100 rounded">LCG</a>
                <a href="#bitwise" class="px-3 py-1 hover:bg-gray-100 rounded">Bitwise</a>
                <a href="#distributions" class="px-3 py-1 hover:bg-gray-100 rounded">Distributions</a>
                <a href="#monte-carlo" class="px-3 py-1 hover:bg-gray-100 rounded">Monte Carlo</a>
            </div>
        </div>
    </nav>

    <header class="pt-24 pb-16 text-center px-4 bg-gradient-to-b from-rose-50 to-transparent">
        <h1 class="text-5xl md:text-6xl font-extrabold text-slate-900 mb-6 tracking-tight">
            Random Numbers üé≤
        </h1>
        <p class="text-xl text-slate-600 max-w-2xl mx-auto mb-8">
            "Anyone who considers arithmetical methods of producing random digits is, of course, in a state of sin." ‚Äî
            John von Neumann
        </p>
        <div class="flex justify-center gap-4 text-sm text-gray-500 font-mono">
            <span>Lecture 2-7</span>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 pb-20">

        <section id="intro" class="slide-card">
            <div class="flex justify-between items-center border-b pb-4 mb-6">
                <h2 class="text-3xl font-bold text-ntu-red">1. Old-Fashioned Randomness üìú</h2>
                <span class="bg-gray-100 px-3 py-1 rounded text-xs font-mono text-gray-500">Slides 1-5</span>
            </div>

            <div class="grid md:grid-cols-2 gap-8 mb-8">
                <div>
                    <h3 class="font-bold text-lg mb-2">The Pencil Method</h3>
                    <p class="text-slate-600 mb-4">
                        A pencil with sides A, B, C, D. Useful for exams, but not for scientific computing!
                        It lacks speed and precision.
                    </p>

                    <h3 class="font-bold text-lg mb-2">Random Number Tables</h3>
                    <p class="text-slate-600 mb-4">
                        Before computers, people used books full of random digits. These tables taught us two
                        fundamental properties of pseudo-randomness:
                    </p>
                    <ul class="list-disc ml-5 text-slate-600">
                        <li>You need a seed to start.</li>
                        <li>It relies on recursive operations.</li>
                    </ul>
                </div>

                <div class="bg-gray-50 p-6 rounded-lg border border-gray-200">
                    <h4 class="font-bold text-gray-700 mb-2">True vs Pseudo Generators</h4>
                    <div class="space-y-3 text-sm text-gray-600">
                        <div>
                            <strong class="text-gray-900">True Random:</strong>
                            <p>Measures physical phenomena (thermal noise, photoelectric effect). Essential for
                                cryptography.</p>
                        </div>
                        <hr>
                        <div>
                            <strong class="text-gray-900">Pseudo Random:</strong>
                            <p>Computational algorithms. Deterministic sequences determined by a seed. <span
                                    class="text-ntu-red font-bold">Good enough for scientific work.</span></p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="lcg" class="slide-card">
            <div class="flex justify-between items-center border-b pb-4 mb-6">
                <h2 class="text-3xl font-bold text-ntu-red">2. Linear Congruential Generator (LCG)</h2>
                <span class="bg-gray-100 px-3 py-1 rounded text-xs font-mono text-gray-500">Slides 7-11</span>
            </div>

            <p class="mb-4 text-lg">A classical algorithm. Simple, commonly used, but potentially dangerous.</p>

            <div class="math-box text-center text-xl">
                $$ R_{next} = (a \cdot R_{current} + c) \mod M $$
            </div>

            <p class="text-slate-600 mb-8">
                Where $a, c$ are scaling constants and $M$ is the modulus. The period is at most $M$.
            </p>

            <div class="mb-10">
                <h3 class="font-bold text-lg mb-2 text-red-700">Example: A Bad LCG ($M=100$)</h3>
                <p class="text-sm text-gray-500 mb-4">Watch how quickly the sequence repeats.</p>
                <div id="code-01"></div>
            </div>

            <div class="mb-10">
                <h3 class="font-bold text-lg mb-2 text-green-700">Example: Park-Miller RNG (Good)</h3>
                <p class="text-sm text-gray-500 mb-4">Uses $a=16807, c=0, M=2^{31}-1$. The period is almost $2^{31}-1$.
                </p>
                <div id="code-01a"></div>
            </div>

            <div class="bg-red-50 p-4 rounded border border-red-100 mt-6">
                <h4 class="font-bold text-red-800 mb-1">‚ö†Ô∏è The RANDU Disaster</h4>
                <p class="text-sm text-red-900">
                    IBM used $a=65539, M=2^{31}$ in the 1960s. It produces numbers that fall into just 15
                    planes in 3D space!
                </p>
            </div>
        </section>

        <section id="bitwise" class="slide-card">
            <div class="flex justify-between items-center border-b pb-4 mb-6">
                <h2 class="text-3xl font-bold text-ntu-red">3. Bitwise Generators üíª</h2>
                <span class="bg-gray-100 px-3 py-1 rounded text-xs font-mono text-gray-500">Slides 19-27</span>
            </div>

            <div class="grid md:grid-cols-2 gap-8 mb-8">
                <div>
                    <h3 class="font-bold text-lg mb-2 text-indigo-600">XORSHIFT Algorithm</h3>
                    <div class="math-box text-sm">
                        $x \leftarrow x \text{ xor } (x \gg a_1)$<br>
                        $x \leftarrow x \text{ xor } (x \ll a_2)$<br>
                        $x \leftarrow x \text{ xor } (x \gg a_3)$
                    </div>
                    <div id="code-02"></div>
                </div>

                <div>
                    <h3 class="font-bold text-lg mb-2 text-indigo-600">Multiply With Carry (MWC)</h3>
                    <div class="math-box text-sm">
                        Uses 64-bit logic.<br>
                        $(x \& \text{mask}) \cdot a + (x \gg 32)$
                    </div>
                    <div id="code-03"></div>
                </div>
            </div>

            <div class="mt-8">
                <h3 class="font-bold text-lg mb-2 text-indigo-800">Combined Generator (The Beast)</h3>
                <p class="text-sm mb-4 text-gray-600">Combining XORSHIFT + MWC yields a massive period of $\approx
                    10^{37}$.</p>
                <div id="code-04"></div>
            </div>
        </section>

        <section id="distributions" class="slide-card">
            <div class="flex justify-between items-center border-b pb-4 mb-6">
                <h2 class="text-3xl font-bold text-ntu-red">4. Non-Uniform Distributions üìä</h2>
                <span class="bg-gray-100 px-3 py-1 rounded text-xs font-mono text-gray-500">Slides 30-50</span>
            </div>

            <div class="mb-8 p-4 bg-red-50 border border-red-100 rounded">
                <h4 class="font-bold text-red-700 mb-2">‚ùå The Wrong Way</h4>
                <p class="text-sm mb-4">Just plugging random numbers into $f(x)$ does <strong>not</strong> produce
                    distribution $f(x)$.</p>
                <div id="code-05"></div>
            </div>

            <div class="mb-12">
                <h4 class="font-bold text-blue-700 text-xl mb-4">‚úÖ Method 1: Hit-or-Miss (Rejection Sampling)</h4>
                <p class="text-sm text-slate-600 mb-4">Generate random $(x, y)$. Keep $x$ only if $y < f(x)$. Simple but
                        inefficient.</p>
                        <div id="code-06"></div>
            </div>

            <div class="mb-12">
                <h4 class="font-bold text-green-700 text-xl mb-4">‚úÖ Method 2: Inverse Transform</h4>
                <div class="math-box text-sm mb-4">
                    Solve $x = W^{-1}(r)$. <br>
                    Example: Exponential Decay $f(x) = e^{-x}$. Cumulative $W(x) = 1 - e^{-x}$. Inverse: $x =
                    -\ln(1-r)$.
                </div>
                <div id="code-07"></div>
            </div>

            <div class="grid md:grid-cols-2 gap-8">
                <div>
                    <h4 class="font-bold text-purple-700 mb-2">Gaussian: Box-Muller</h4>
                    <p class="text-xs text-gray-500 mb-2">Transforming uniform coords to polar/Gaussian.</p>
                    <div id="code-08"></div>
                </div>
                <div>
                    <h4 class="font-bold text-purple-700 mb-2">Gaussian: CLT Summation</h4>
                    <p class="text-xs text-gray-500 mb-2">Sum of 12 uniform randoms $\to$ Gaussian.</p>
                    <div id="code-08a"></div>
                </div>
            </div>
        </section>

        <section id="monte-carlo" class="slide-card">
            <div class="flex justify-between items-center border-b pb-4 mb-6">
                <h2 class="text-3xl font-bold text-ntu-red">5. Monte Carlo Integration üéØ</h2>
                <span class="bg-gray-100 px-3 py-1 rounded text-xs font-mono text-gray-500">Slides 52-55</span>
            </div>

            <div class="math-box text-center">
                $$ I \approx (b-a) \langle f \rangle = \frac{V}{N} \sum f(x_i) $$
            </div>

            <h3 class="font-bold text-lg mb-2">6D Integral Example</h3>
            <p class="text-sm text-slate-600 mb-4">Integrating $\sum \sin$ terms over a 6D hypercube. Grid methods fail
                here!</p>
            <div id="code-09"></div>
        </section>

        <section id="hands-on" class="slide-card bg-gradient-to-br from-red-50 to-orange-50 border-red-100">
            <h2 class="text-2xl font-bold text-red-900 mb-6 flex items-center gap-3">
                <span>üëê</span> Hands-On Session
            </h2>
            <div class="grid md:grid-cols-2 gap-8">
                <div class="bg-white p-6 rounded-lg shadow-sm">
                    <h3 class="font-bold text-lg text-red-800 mb-2">Practice 1: Step Function</h3>
                    <p class="text-sm text-gray-600 mb-4">Generate distribution for:</p>
                    <div class="math-box text-xs bg-gray-50">
                        f(x) = 1 (0 < x <=1)<br>
                            f(x) = 2 (1 < x <=2)<br>
                                ...<br>
                                f(x) = 9 (8 < x <=9) </div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-sm">
                        <h3 class="font-bold text-lg text-orange-800 mb-2">Practice 2: Complex Model</h3>
                        <p class="text-sm text-gray-600 mb-4">Generate 10k events for the Higgs fit model:</p>
                        <div class="math-box text-xs bg-gray-50">
                            $$ f(x) = \text{Gaussian} + ax^2 + bx + c $$
                        </div>
                    </div>
                </div>
        </section>

    </main>

    <footer class="bg-white border-t py-12 text-center text-sm text-gray-400 mt-12">
        <p>Numerical Analysis Lecture 2-7</p>
    </footer>

    <script>
        // --- Teach Mode Logic (Preserved from Series 2) ---
        let isTeachMode = false;
        let currentSlide = 0;
        const slides = document.querySelectorAll('.slide-card');

        function toggleTeachMode() {
            isTeachMode = !isTeachMode;
            document.body.classList.toggle('teach-mode');

            if (isTeachMode) {
                updateCurrentSlideFromScroll();
                enterFullscreen();
                showSlide(currentSlide);
            } else {
                exitFullscreen();
                slides[currentSlide].scrollIntoView({ behavior: 'auto', block: 'start' });
            }
        }

        function enterFullscreen() {
            const el = document.documentElement;
            if (el.requestFullscreen) el.requestFullscreen();
            else if (el.webkitRequestFullscreen) el.webkitRequestFullscreen();
        }

        function exitFullscreen() {
            if (document.exitFullscreen) document.exitFullscreen();
            else if (document.webkitExitFullscreen) document.webkitExitFullscreen();
        }

        function showSlide(index) {
            slides.forEach((slide, i) => {
                slide.classList.toggle('active-slide', i === index);
            });
        }

        function nextSlide() {
            if (currentSlide < slides.length - 1) {
                currentSlide++;
                showSlide(currentSlide);
            }
        }

        function prevSlide() {
            if (currentSlide > 0) {
                currentSlide--;
                showSlide(currentSlide);
            }
        }

        function updateCurrentSlideFromScroll() {
            let closestIndex = 0;
            let minDistance = Infinity;
            slides.forEach((slide, i) => {
                const rect = slide.getBoundingClientRect();
                const distance = Math.abs(rect.top);
                if (distance < minDistance) {
                    minDistance = distance;
                    closestIndex = i;
                }
            });
            currentSlide = closestIndex;
        }

        document.addEventListener('keydown', (e) => {
            if (!isTeachMode) return;
            if (e.key === 'ArrowRight' || e.key === ' ' || e.key === 'ArrowDown') nextSlide();
            else if (e.key === 'ArrowLeft' || e.key === 'ArrowUp') prevSlide();
            else if (e.key === 'Escape') {
                if (isTeachMode) toggleTeachMode();
            }
        });

        document.addEventListener('fullscreenchange', () => {
            if (!document.fullscreenElement && isTeachMode) toggleTeachMode();
        });


        // --- Pyodide Setup ---
        let pyodide = null;
        async function initPyodideEnvironment() {
            if (pyodide) return pyodide;
            pyodide = await loadPyodide();
            await pyodide.loadPackage(['numpy', 'matplotlib']);
            return pyodide;
        }

        async function runPythonCode(code) {
            await initPyodideEnvironment();
            const setupCode = `
import sys
import io
import matplotlib
matplotlib.use('Agg')
import matplotlib.pyplot as plt
plt.close('all')
sys.stdout = io.StringIO()
sys.stderr = io.StringIO()
`;
            const cleanupCode = `
stdout_val = sys.stdout.getvalue()
stderr_val = sys.stdout.getvalue()
`;
            const plotSaver = `
import base64
buf = io.BytesIO()
if plt.get_fignums() and len(plt.gcf().axes) > 0:
    plt.savefig(buf, format='png', bbox_inches='tight')
    buf.seek(0)
    img_str = base64.b64encode(buf.read()).decode('UTF-8')
else:
    img_str = ""
img_str
`;
            try {
                await pyodide.runPythonAsync(setupCode + code + cleanupCode);
                const stdout = pyodide.runPython("stdout_val");
                const stderr = pyodide.runPython("stderr_val");
                const imgB64 = pyodide.runPython(plotSaver);
                return { stdout, stderr, image: imgB64 ? 'data:image/png;base64,' + imgB64 : null };
            } catch (err) {
                return { error: err.message };
            }
        }
    </script>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const CodeRunner = ({ id, filename, initialCode }) => {
            const [code, setCode] = useState(initialCode);
            const [output, setOutput] = useState("");
            const [imageSrc, setImageSrc] = useState(null);
            const [status, setStatus] = useState("idle");
            const textareaRef = useRef(null);
            const preRef = useRef(null);

            useEffect(() => {
                if (preRef.current) {
                    preRef.current.removeAttribute('data-highlighted');
                    hljs.highlightElement(preRef.current);
                }
            }, [code]);

            const handleRun = async () => {
                setStatus("running");
                setOutput("");
                setImageSrc(null);
                const result = await runPythonCode(code);
                if (result.error) {
                    setStatus("error");
                    setOutput(result.error);
                } else {
                    setStatus("success");
                    setOutput(result.stdout || (result.image ? "" : "Done (no output)"));
                    if (result.image) setImageSrc(result.image);
                }
            };

            const handleScroll = () => {
                if (textareaRef.current && preRef.current) {
                    preRef.current.scrollTop = textareaRef.current.scrollTop;
                    preRef.current.scrollLeft = textareaRef.current.scrollLeft;
                }
            };

            const handleKeyDown = (e) => {
                if (e.key === 'Tab') {
                    e.preventDefault();
                    const start = e.target.selectionStart;
                    const end = e.target.selectionEnd;
                    setCode(code.substring(0, start) + "    " + code.substring(end));
                    setTimeout(() => { e.target.selectionStart = e.target.selectionEnd = start + 4; }, 0);
                }
            };

            return (
                <div className="mb-6">
                    <div className="editor-container">
                        <div className="run-bar">
                            <span className="text-xs font-mono text-gray-500 font-bold">{filename}</span>
                            <button onClick={handleRun} disabled={status === 'running'} className="run-btn">
                                {status === 'running' ? 'Running...' : '‚ñ∂ Run Code'}
                            </button>
                        </div>
                        <div className="editor-wrapper">
                            <textarea
                                ref={textareaRef}
                                value={code}
                                onChange={(e) => setCode(e.target.value)}
                                onScroll={handleScroll}
                                onKeyDown={handleKeyDown}
                                spellCheck="false"
                            />
                            <pre ref={preRef}><code className="language-python">{code}</code></pre>
                        </div>
                    </div>
                    <div className="output-box">
                        {status === 'idle' && <div className="text-gray-400 italic">Click run to start...</div>}
                        {status === 'running' && <div className="text-blue-500 animate-pulse">Running simulation...</div>}
                        {status === 'error' && <div className="text-red-500 font-bold">Error Traceback:</div>}
                        <div>{output}</div>
                        {imageSrc && <img src={imageSrc} className="output-img" />}
                    </div>
                </div>
            );
        };

        const code01 = `class rnd:
    def __init__(self, s = 1234):
        self.seed = s
        
    def gen(self):
        # a=32533521, c=2424, M=100
        self.seed = (32533521*self.seed + 2424) % 100
        return self.seed

r = rnd()
for i in range(30):
    print(r.gen(), end=' ')`;

        const code01a = `class rnd:
    def __init__(self, s = 1234):
        self.seed = s
        
    def gen(self):
        self.seed = (16807*self.seed) % (2**31-1)
        return self.seed

r = rnd()
for i in range(30):
    print(r.gen(), end=' ')`;

        const code02 = `class rnd:
    def __init__(self, s = 1234):
        self.seed = s
                
    def gen(self):
        self.seed = self.seed ^ (self.seed >> 21)
        self.seed = self.seed ^ (self.seed << 35)
        self.seed = self.seed ^ (self.seed >>  4)
        return (self.seed & 0xffffffff)

r = rnd()
for i in range(30):
    print(r.gen(), end=' ')`;

        const code03 = `class rnd:
    def __init__(self, s = 1234):
        self.seed = s
    
    def gen(self):
        self.seed = \\
        (self.seed & 0xffffffff)*4294957665 + (self.seed>>32)
        return (self.seed & 0xffffffff)

r = rnd()
for i in range(30):
    print(r.gen(), end=' ')`;

        const code04 = `class rnd:
    def __init__(self, s1 = 1234, s2 = 5678):
        self.s1 = s1
        self.s2 = s2
                
    def gen(self):        
        self.s1 = self.s1 ^ (self.s1 >> 17)
        self.s1 = self.s1 ^ (self.s1 << 31)
        self.s1 = self.s1 ^ (self.s1 >>  8)
        self.s2 = (self.s2 & 0xffffffff)*4294957665 + (self.s2>>32)
        return ((self.s1 ^ self.s2) & 0xffffffff)
	
r = rnd()
for i in range(30):
    print(r.gen(), end=' ')`;

        const code05 = `import numpy as np
import matplotlib.pyplot as plt
    
def f(x):
    return x
    
x = np.random.rand(100000)
data = f(x)

plt.hist(data, bins=50, range=(0.,1.), color='y')
plt.show()`;

        const code06 = `import numpy as np
import matplotlib.pyplot as plt
    
def f(x):
    return x - x**2 + x**3 - x**4 + np.sin(x*13.)/13.
    
x = np.random.rand(20000)
y = np.random.rand(20000)*0.45
data = x[y<f(x)]

plt.hist(data, bins=50, range=(0.,1.), color='y')
plt.show()`;

        const code07 = `import numpy as np
import matplotlib.pyplot as plt
    
r = np.random.rand(10000)
data = -np.log(1.-r+r/np.exp(1.))

plt.hist(data, bins=50, range=(0.,1.), color='y')
plt.show()`;

        const code08 = `import numpy as np
import matplotlib.pyplot as plt

plt.figure(figsize=(10,5), dpi=80)
    
r1 = np.random.rand(10000)
r2 = np.random.rand(10000)
x = (-2.*np.log(r1))**0.5*np.cos(2.*np.pi*r2)
y = (-2.*np.log(r1))**0.5*np.sin(2.*np.pi*r2)

plt.subplot(1,2,1)
plt.hist(x, bins=50, range=(-5.,+5.), color='y')

plt.subplot(1,2,2)
plt.hist(y, bins=50, range=(-5.,+5.), color='c')

plt.show()`;

        const code08a = `import numpy as np
import matplotlib.pyplot as plt

plt.figure(figsize=(6,6), dpi=80)
    
r = np.random.rand(10000)
r += np.random.rand(10000)
r += np.random.rand(10000)
r += np.random.rand(10000)
r += np.random.rand(10000)
r += np.random.rand(10000)

plt.hist(r, bins=50, range=(0.,+6.), color='y')
plt.show()`;

        const code09 = `import numpy as np

def func(a, b, c, d, e, f):
    return np.sin(a)+np.sin(b*2.)+np.sin(c*3.)+np.cos(d)+np.cos(e*2.)+np.cos(f*3.)

def intfunc(a, b, c, d, e, f):
    return -np.cos(a)-np.cos(b*2.)/2.-np.cos(c*3.)/3.+np.sin(d)+np.sin(e*2.)/2.+np.sin(f*3.)/3.


intf_exact = intfunc(1.,1.,1.,1.,1.,1.)-intfunc(0.,0.,0.,0.,0.,0.)
print("Exact  = %+.5f" % intf_exact)

nsamples = 1000000 # 1 million trials
v = np.random.rand(nsamples,6)
val = func(v[:,0],v[:,1],v[:,2],v[:,3],v[:,4],v[:,5])
intf_rand = val.sum() / nsamples
intf_rand_err = (((val**2).sum()/nsamples-intf_rand**2)/(nsamples-1))**0.5
print("Random = %+.6f +- %.6f" % (intf_rand,intf_rand_err))
print(" (diff = %+.6f)" % (intf_rand-intf_exact))

sep = np.linspace(0.025,0.975,20)
va,vb,vc,vd,ve,vf = np.meshgrid(sep,sep,sep,sep,sep,sep)
intf_boxes = func(va,vb,vc,vd,ve,vf).sum() * 0.05**6
print("Boxes  = %+.6f" % intf_boxes)
print(" (diff = %+.6f)" % (intf_boxes-intf_exact))`;

        const root = ReactDOM.createRoot(document.getElementById('code-01'));
        root.render(<CodeRunner filename="l207-example-01.py" initialCode={code01} />);

        ReactDOM.createRoot(document.getElementById('code-01a')).render(<CodeRunner filename="l207-example-01a.py" initialCode={code01a} />);
        ReactDOM.createRoot(document.getElementById('code-02')).render(<CodeRunner filename="l207-example-02.py" initialCode={code02} />);
        ReactDOM.createRoot(document.getElementById('code-03')).render(<CodeRunner filename="l207-example-03.py" initialCode={code03} />);
        ReactDOM.createRoot(document.getElementById('code-04')).render(<CodeRunner filename="l207-example-04.py" initialCode={code04} />);
        ReactDOM.createRoot(document.getElementById('code-05')).render(<CodeRunner filename="l207-example-05.py" initialCode={code05} />);
        ReactDOM.createRoot(document.getElementById('code-06')).render(<CodeRunner filename="l207-example-06.py" initialCode={code06} />);
        ReactDOM.createRoot(document.getElementById('code-07')).render(<CodeRunner filename="l207-example-07.py" initialCode={code07} />);
        ReactDOM.createRoot(document.getElementById('code-08')).render(<CodeRunner filename="l207-example-08.py" initialCode={code08} />);
        ReactDOM.createRoot(document.getElementById('code-08a')).render(<CodeRunner filename="l207-example-08a.py" initialCode={code08a} />);
        ReactDOM.createRoot(document.getElementById('code-09')).render(<CodeRunner filename="l207-example-09.py" initialCode={code09} />);

        renderMathInElement(document.body, {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false }
            ]
        });
    </script>
</body>

</html>