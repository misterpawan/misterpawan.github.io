<!DOCTYPE html>
<html lang="en" class="scroll-smooth">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sinkhorn Generative Modeling | Generative Modelling</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = { tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] } };</script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>tailwind.config = { darkMode: 'class', theme: { extend: { fontFamily: { sans: ['Inter', 'sans-serif'] }, colors: { primary: '#ec4899', ink: '#0f172a' } } } };</script>
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <style>
        .glass {
            background: rgba(255, 255, 255, 0.78);
            backdrop-filter: blur(14px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .dark .glass {
            background: rgba(17, 24, 39, 0.85);
            border: 1px solid rgba(255, 255, 255, 0.06);
        }

        .quiz-option:hover {
            background-color: #fff1f2;
            border-color: #ec4899;
        }

        .dark .quiz-option:hover {
            background-color: #374151;
            border-color: #ec4899;
        }

        .correct {
            background-color: #d1fae5 !important;
            border-color: #10b981 !important;
        }

        .wrong {
            background-color: #fee2e2 !important;
            border-color: #ef4444 !important;
        }

        .proof-box {
            border-left: 4px solid #8b5cf6;
            background: linear-gradient(to right, #f3e8ff, #fae8ff);
        }

        .dark .proof-box {
            background: linear-gradient(to right, #1e1b4b, #3b0764);
        }

        @keyframes flow {

            0%,
            100% {
                stroke-dashoffset: 0;
            }

            50% {
                stroke-dashoffset: 20;
            }
        }

        .animated-flow {
            animation: flow 2s linear infinite;
        }
    </style>
</head>

<body
    class="bg-gradient-to-br from-purple-50 via-white to-pink-50 text-ink dark:from-gray-900 dark:via-gray-950 dark:to-gray-900 dark:text-gray-100 font-sans">
    <div class="fixed top-0 left-0 w-full h-1 bg-gray-200 z-50">
        <div id="progress-bar" class="h-full bg-primary w-0 transition-all"></div>
    </div>
    <nav class="sticky top-4 z-40 max-w-5xl mx-auto px-4 mb-8 pt-4">
        <div class="glass rounded-2xl shadow-lg p-4 flex justify-between items-center">
            <a href="index.html"
                class="flex items-center gap-2 font-bold text-sm sm:text-base hover:text-primary transition"><span>‚Üê</span>
                Back to Course</a>
            <div class="flex gap-3 text-xs sm:text-sm">
                <span class="px-3 py-1 rounded-full bg-pink-100 text-pink-700">Optimal Transport</span>
                <span class="px-3 py-1 rounded-full bg-purple-100 text-purple-700">Sinkhorn</span>
            </div>
        </div>
    </nav>
    <main class="max-w-5xl mx-auto px-4 pb-24 space-y-12">
        <header class="text-center py-8" data-aos="fade-down">
            <h1
                class="text-4xl md:text-5xl font-extrabold mb-4 bg-clip-text text-transparent bg-gradient-to-r from-pink-600 to-purple-600">
                Sinkhorn Generative Modeling</h1>
            <p class="text-xl text-gray-700 dark:text-gray-300 max-w-3xl mx-auto">From optimal transport to fast
                entropy-regularized algorithms for generative modeling</p>
        </header>

        <!-- Optimal Transport Introduction -->
        <section class="glass p-8 rounded-3xl" data-aos="fade-up">
            <div class="flex items-center gap-3 mb-4">
                <span class="bg-pink-100 text-pink-700 p-2 rounded-xl">üöö</span>
                <h2 class="text-2xl font-bold">Optimal Transport: The Assignment Problem</h2>
            </div>
            <p class="mb-4 text-gray-700 dark:text-gray-300">
                <strong>Problem:</strong> How to optimally assign points from set $X = \{x_1, \ldots, x_n\}$ to points
                in set $Y = \{y_1, \ldots, y_m\}$ while minimizing total cost?
            </p>

            <!-- Visual Assignment Demo -->
            <div
                class="bg-gradient-to-br from-blue-50 to-purple-50 dark:from-gray-800 dark:to-gray-900 p-6 rounded-2xl mb-6">
                <h3 class="font-bold mb-4 text-center">Interactive Assignment Visualization</h3>
                <svg width="100%" height="300" viewBox="0 0 600 300" class="mx-auto">
                    <!-- Source points (red) -->
                    <circle cx="100" cy="50" r="12" fill="#ef4444" />
                    <text x="100" y="35" text-anchor="middle" font-size="11" fill="#7f1d1d">x‚ÇÅ</text>
                    <circle cx="80" cy="150" r="12" fill="#ef4444" />
                    <text x="80" y="135" text-anchor="middle" font-size="11" fill="#7f1d1d">x‚ÇÇ</text>
                    <circle cx="120" cy="250" r="12" fill="#ef4444" />
                    <text x="120" y="235" text-anchor="middle" font-size="11" fill="#7f1d1d">x‚ÇÉ</text>
                    <circle cx="50" cy="180" r="12" fill="#ef4444" />
                    <text x="50" y="165" text-anchor="middle" font-size="11" fill="#7f1d1d">x‚ÇÑ</text>

                    <!-- Destination points (blue) -->
                    <circle cx="500" cy="70" r="12" fill="#3b82f6" />
                    <text x="500" y="55" text-anchor="middle" font-size="11" fill="#1e3a8a">y‚ÇÅ</text>
                    <circle cx="520" cy="140" r="12" fill="#3b82f6" />
                    <text x="520" y="125" text-anchor="middle" font-size="11" fill="#1e3a8a">y‚ÇÇ</text>
                    <circle cx="480" cy="220" r="12" fill="#3b82f6" />
                    <text x="480" y="205" text-anchor="middle" font-size="11" fill="#1e3a8a">y‚ÇÉ</text>
                    <circle cx="550" cy="200" r="12" fill="#3b82f6" />
                    <text x="550" y="185" text-anchor="middle" font-size="11" fill="#1e3a8a">y‚ÇÑ</text>

                    <!-- Assignment arrows -->
                    <path d="M 112 50 L 488 70" stroke="#10b981" stroke-width="3" class="animated-flow"
                        stroke-dasharray="10,5" marker-end="url(#arrow)" />
                    <path d="M 92 150 L 508 140" stroke="#10b981" stroke-width="3" class="animated-flow"
                        stroke-dasharray="10,5" marker-end="url(#arrow)" />
                    <path d="M 132 250 L 468 220" stroke="#10b981" stroke-width="3" class="animated-flow"
                        stroke-dasharray="10,5" marker-end="url(#arrow)" />
                    <path d="M 62 180 L 538 200" stroke="#10b981" stroke-width="3" class="animated-flow"
                        stroke-dasharray="10,5" marker-end="url(#arrow)" />

                    <defs>
                        <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                            <polygon points="0 0, 10 3, 0 6" fill="#10b981" />
                        </marker>
                    </defs>

                    <!-- Labels -->
                    <text x="300" y="20" text-anchor="middle" font-size="14" font-weight="bold" fill="#059669">Optimal
                        Assignment</text>
                </svg>
                <p class="text-sm text-center text-gray-600 dark:text-gray-400 mt-4">
                    Animated flows show one-to-one matching minimizing total distance
                </p>
            </div>

            <div class="bg-yellow-50 dark:bg-gray-800 p-4 rounded-xl border-l-4 border-yellow-400 mb-4">
                <p class="text-sm font-semibold mb-2">‚ö†Ô∏è Limitations of Simple Assignment:</p>
                <ul class="text-sm space-y-1 text-gray-700 dark:text-gray-300">
                    <li>‚úó Requires $|X| = |Y|$ (equal sizes)</li>
                    <li>‚úó No out-of-sample extension for new points</li>
                    <li>‚úó Computational cost: $O(n^3)$ via Hungarian algorithm</li>
                    <li>‚úó Cannot handle probability distributions directly</li>
                </ul>
            </div>
        </section>

        <!-- OT Definition -->
        <section class="space-y-6" data-aos="fade-up">
            <div class="flex items-center gap-3">
                <span class="bg-purple-100 text-purple-700 p-2 rounded-xl">üìê</span>
                <h2 class="text-2xl font-bold">Optimal Transport: Formal Definition</h2>
            </div>

            <div class="glass p-8 rounded-2xl">
                <div class="proof-box p-6 rounded-xl mb-6">
                    <h3 class="font-bold mb-3 text-purple-900 dark:text-purple-200">Definition: Optimal Transport</h3>
                    <p class="mb-3 text-gray-700 dark:text-gray-300">
                        Let $(X,p)$, $(Y,q)$ be finite probability spaces with $|X|=n$, $|Y|=m$. Let $\Pi(p,q)$ be the
                        set of joint distributions on $X \times Y$ with marginals $p$ and $q$:
                    </p>
                    <div class="bg-white dark:bg-gray-900 p-4 rounded-lg mb-3">
                        <p class="text-center font-mono">
                            $\Pi(p,q) = \{\pi : \pi \mathbf{1}_m = p, \, \mathbf{1}_n^T \pi = q\}$
                        </p>
                    </div>
                    <p class="mb-3 text-gray-700 dark:text-gray-300">
                        Given cost function $c: X \times Y \to \mathbb{R}_+$, the <strong>optimal transport
                            distance</strong> is:
                    </p>
                    <div class="bg-white dark:bg-gray-900 p-4 rounded-lg">
                        <p class="text-center font-mono text-lg">
                            $d_c(p,q) = \min_{\pi \in \Pi(p,q)} \langle c, \pi \rangle = \min_{\pi \in \Pi(p,q)}
                            \sum_{x,y} c(x,y)\pi(x,y)$
                        </p>
                    </div>
                </div>

                <div class="grid md:grid-cols-2 gap-4">
                    <div class="p-4 rounded-xl bg-blue-50 dark:bg-gray-800 border border-blue-200">
                        <h4 class="font-bold mb-2 text-blue-700 dark:text-blue-300">Marginal Constraints</h4>
                        <p class="text-sm text-gray-700 dark:text-gray-300 mb-2">Row sums match source $p$:</p>
                        <p class="text-xs font-mono">$\sum_y \pi(x,y) = p(x)$</p>
                        <p class="text-sm text-gray-700 dark:text-gray-300 mb-2 mt-2">Column sums match target $q$:</p>
                        <p class="text-xs font-mono">$\sum_x \pi(x,y) = q(y)$</p>
                    </div>
                    <div class="p-4 rounded-xl bg-green-50 dark:bg-gray-800 border border-green-200">
                        <h4 class="font-bold mb-2 text-green-700 dark:text-green-300">Special Case: Wasserstein</h4>
                        <p class="text-sm text-gray-700 dark:text-gray-300 mb-2">If $c(x,y) = \|x-y\|_2$:</p>
                        <p class="text-xs font-mono">$d_c(p,q) = W_1(p,q)$</p>
                        <p class="text-xs text-gray-600 dark:text-gray-400 mt-2">(1-Wasserstein distance)</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Quiz 1 -->
        <section class="glass p-6 rounded-3xl border-2 border-pink-100 dark:border-gray-700" data-aos="zoom-in">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold flex items-center gap-2">üß† Quiz 1 <span
                        class="text-xs bg-pink-100 text-pink-700 px-2 py-1 rounded-full">Understanding</span></h3>
                <button onclick="resetQuiz1()" class="text-sm text-primary font-semibold">Reset</button>
            </div>
            <p class="mb-3 font-semibold">What does the constraint $\pi \mathbf{1}_m = p$ ensure in optimal transport?
            </p>
            <div class="grid gap-3">
                <button
                    class="quiz-option p-4 rounded-xl border border-gray-200 dark:border-gray-600 transition text-left"
                    onclick="markQuiz1(this, false)">
                    The total cost is minimized
                </button>
                <button
                    class="quiz-option p-4 rounded-xl border border-gray-200 dark:border-gray-600 transition text-left"
                    onclick="markQuiz1(this, true)">
                    The row sums of the transport plan œÄ match the source distribution p
                </button>
                <button
                    class="quiz-option p-4 rounded-xl border border-gray-200 dark:border-gray-600 transition text-left"
                    onclick="markQuiz1(this, false)">
                    The cost matrix has unit row sums
                </button>
            </div>
            <p id="quiz1-feedback" class="mt-3 text-sm font-semibold"></p>
        </section>

        <!-- Entropy Regularization -->
        <section class="space-y-6" data-aos="fade-up">
            <div class="flex items-center gap-3">
                <span class="bg-indigo-100 text-indigo-700 p-2 rounded-xl">üî•</span>
                <h2 class="text-2xl font-bold">Entropy Regularization</h2>
            </div>

            <div class="glass p-8 rounded-2xl">
                <p class="mb-4 text-gray-700 dark:text-gray-300">
                    To improve stability and enable fast algorithms, we add an entropy regularization term:
                </p>

                <div
                    class="bg-gradient-to-r from-indigo-50 to-purple-50 dark:from-gray-800 dark:to-gray-900 p-6 rounded-2xl mb-6">
                    <h3 class="font-bold mb-3 text-center">Entropy-Regularized OT</h3>
                    <div class="bg-white dark:bg-gray-900 p-4 rounded-lg">
                        <p class="text-center font-mono text-lg">
                            $d_c^\lambda(p,q) = \min_{\pi \in \Pi(p,q)} \langle c, \pi \rangle - \lambda H(\pi)$
                        </p>
                        <p class="text-center text-sm mt-2 text-gray-600 dark:text-gray-400">
                            where $H(\pi) = -\sum_{x,y} \pi(x,y) \log \pi(x,y)$ is the entropy
                        </p>
                    </div>
                </div>

                <div class="proof-box p-6 rounded-xl mb-6">
                    <h3 class="font-bold mb-3 text-purple-900 dark:text-purple-200">Key Insight: KL Divergence
                        Reformulation</h3>
                    <p class="mb-3 text-sm text-gray-700 dark:text-gray-300">
                        Define $K(x,y) = e^{-c(x,y)/\lambda}$ and Gibbs distribution $p_K^\lambda = K/z_\lambda$ where
                        $z_\lambda = \sum_{x,y} K(x,y)$. Then:
                    </p>
                    <div class="bg-white dark:bg-gray-900 p-4 rounded-lg space-y-2 text-sm">
                        <p>$D_{KL}(\pi \| p_K^\lambda) = \sum_{x,y} \pi(x,y) \log\frac{\pi(x,y)}{K(x,y)/z_\lambda}$</p>
                        <p>$\quad = \sum_{x,y} \pi(x,y) \log \pi(x,y) - \sum_{x,y}
                            \pi(x,y)\left(-\frac{c(x,y)}{\lambda}\right) + \log z_\lambda$</p>
                        <p>$\quad = -H(\pi) + \frac{1}{\lambda}\langle c, \pi \rangle + \log z_\lambda$</p>
                    </div>
                    <p class="mt-3 text-sm font-semibold text-purple-900 dark:text-purple-200">
                        Therefore: $\arg\min_{\pi \in \Pi(p,q)} \langle c, \pi \rangle - \lambda H(\pi) = \arg\min_{\pi
                        \in \Pi(p,q)} D_{KL}(\pi \| p_K^\lambda)$
                    </p>
                </div>

                <div class="grid md:grid-cols-2 gap-4">
                    <div class="p-4 rounded-xl bg-green-50 dark:bg-gray-800 border border-green-200">
                        <h4 class="font-bold mb-2 text-green-700 dark:text-green-300">‚úì Benefits</h4>
                        <ul class="text-xs space-y-1">
                            <li>‚Ä¢ Unique solution (strongly convex)</li>
                            <li>‚Ä¢ Fast $O(nm)$ algorithm</li>
                            <li>‚Ä¢ Smooth optimization landscape</li>
                        </ul>
                    </div>
                    <div class="p-4 rounded-xl bg-blue-50 dark:bg-gray-800 border border-blue-200">
                        <h4 class="font-bold mb-2 text-blue-700 dark:text-blue-300">üìä Convergence</h4>
                        <p class="text-xs">As $\lambda \to 0$:</p>
                        <p class="text-xs font-mono mt-1">$d_c^\lambda(p,q) \to d_c(p,q)$</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Sinkhorn Algorithm -->
        <section class="space-y-6" data-aos="fade-up">
            <div class="flex items-center gap-3">
                <span class="bg-cyan-100 text-cyan-700 p-2 rounded-xl">‚ö°</span>
                <h2 class="text-2xl font-bold">Sinkhorn Algorithm</h2>
            </div>

            <div class="glass p-8 rounded-2xl">
                <div class="proof-box p-6 rounded-xl mb-6">
                    <h3 class="font-bold mb-3 text-purple-900 dark:text-purple-200">Proposition: Matrix Scaling Form
                    </h3>
                    <p class="mb-3 text-sm text-gray-700 dark:text-gray-300">
                        The optimal transport plan has the form:
                    </p>
                    <div class="bg-white dark:bg-gray-900 p-4 rounded-lg mb-3">
                        <p class="text-center font-mono">$\pi_\lambda^* = \text{diag}(u) K \text{diag}(v)$</p>
                    </div>
                    <p class="text-sm text-gray-700 dark:text-gray-300">
                        where $K_{xy} = e^{-c(x,y)/\lambda}$ and $u \in \mathbb{R}^n, v \in \mathbb{R}^m$ are scaling
                        vectors.
                    </p>
                    <details class="mt-3 text-sm">
                        <summary class="cursor-pointer font-semibold text-purple-700 dark:text-purple-300">Click to see
                            proof</summary>
                        <div class="mt-2 p-3 bg-white dark:bg-gray-900 rounded">
                            <p class="mb-2">Using Lagrangian with multipliers $f, g$:</p>
                            <p class="text-xs mb-1">$L(\pi,f,g) = \langle c, \pi \rangle - \lambda H(\pi) + \langle f, p
                                - \pi\mathbf{1}_m \rangle + \langle g, q - \mathbf{1}_n^T\pi \rangle$</p>
                            <p class="mb-2">First-order optimality at $(x,y)$:</p>
                            <p class="text-xs mb-1">$c(x,y) + \lambda(\log\pi(x,y) + 1) - f_x - g_y = 0$</p>
                            <p class="mb-2">Solving for $\pi(x,y)$:</p>
                            <p class="text-xs">$\pi(x,y) = e^{(f_x/\lambda - 1/2)} e^{-c(x,y)/\lambda} e^{(g_y/\lambda -
                                1/2)}$</p>
                            <p class="mt-2">Setting $u_x = e^{f_x/\lambda - 1/2}$ and $v_y = e^{g_y/\lambda - 1/2}$
                                yields the result. ‚àé</p>
                        </div>
                    </details>
                </div>

                <div
                    class="bg-gradient-to-br from-cyan-50 to-blue-50 dark:from-gray-800 dark:to-gray-900 p-6 rounded-2xl mb-6">
                    <h3 class="font-bold mb-4 text-center">Algorithm: Sinkhorn Iterations</h3>
                    <div class="space-y-2 font-mono text-sm bg-white dark:bg-gray-900 p-4 rounded-lg">
                        <p><span class="text-pink-600">1:</span> <span class="text-gray-700 dark:text-gray-300">Compute
                                $K = \exp(-C/\lambda)$</span></p>
                        <p><span class="text-pink-600">2:</span> <span
                                class="text-gray-700 dark:text-gray-300">Initialize $u^{(0)} = \mathbf{1}_n, v^{(0)} =
                                \mathbf{1}_m$</span></p>
                        <p><span class="text-pink-600">3:</span> <span class="text-purple-600">for</span> <span
                                class="text-gray-700 dark:text-gray-300">$\ell = 1$ to $L$:</span></p>
                        <p class="ml-6"><span class="text-pink-600">4:</span> <span
                                class="text-gray-700 dark:text-gray-300">$u^{(\ell)} = p \oslash (K
                                v^{(\ell-1)})$</span> <span class="text-xs text-gray-500">(element-wise division)</span>
                        </p>
                        <p class="ml-6"><span class="text-pink-600">5:</span> <span
                                class="text-gray-700 dark:text-gray-300">$v^{(\ell)} = q \oslash (K^T
                                u^{(\ell)})$</span></p>
                        <p><span class="text-pink-600">6:</span> <span class="text-gray-700 dark:text-gray-300">Return
                                $\pi = \text{diag}(u^{(L)}) K \text{diag}(v^{(L)})$</span></p>
                    </div>
                    <div class="mt-4 p-3 bg-green-50 dark:bg-gray-800 rounded-lg border-l-4 border-green-400">
                        <p class="text-xs font-semibold text-green-900 dark:text-green-200">‚úì Complexity: $O(Lnm)$ where
                            $L$ is number of iterations</p>
                        <p class="text-xs text-gray-700 dark:text-gray-300 mt-1">Much faster than LP solvers which take
                            $O(nm(n+m)\log(n+m))$</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Quiz 2 -->
        <section class="glass p-6 rounded-3xl border-2 border-pink-100" data-aos="zoom-in">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold flex items-center gap-2">üîç Spot the Mistake! <span
                        class="text-xs bg-pink-100 text-pink-700 px-2 py-1 rounded-full">Challenge</span></h3>
                <button onclick="resetQuiz2()" class="text-sm text-primary font-semibold">Reset</button>
            </div>
            <p class="mb-3 font-semibold">Which statement about Sinkhorn algorithm is INCORRECT?</p>
            <div class="grid gap-3">
                <button class="quiz-option p-4 rounded-xl border border-gray-200 transition text-left text-sm"
                    onclick="markQuiz2(this, false)">
                    Sinkhorn alternates between scaling rows and columns of the kernel matrix K
                </button>
                <button class="quiz-option p-4 rounded-xl border border-gray-200 transition text-left text-sm"
                    onclick="markQuiz2(this, true)">
                    The optimal transport plan œÄ = diag(u)K diag(v) always has integer entries representing discrete
                    assignments
                </button>
                <button class="quiz-option p-4 rounded-xl border border-gray-200 transition text-left text-sm"
                    onclick="markQuiz2(this, false)">
                    The algorithm complexity is O(Lnm) which is faster than cubic LP solvers
                </button>
            </div>
            <p id="quiz2-feedback" class="mt-3 text-sm font-semibold"></p>
        </section>

        <!-- Sinkhorn for Generation -->
        <section class="space-y-6" data-aos="fade-up">
            <div class="flex items-center gap-3">
                <span class="bg-pink-100 text-pink-700 p-2 rounded-xl">üé®</span>
                <h2 class="text-2xl font-bold">Sinkhorn Generative Modeling</h2>
            </div>

            <div class="glass p-8 rounded-2xl">
                <p class="mb-6 text-gray-700 dark:text-gray-300">
                    Use Sinkhorn algorithm to train generators by minimizing the optimal transport distance between
                    generated and real distributions!
                </p>

                <!-- Architecture Diagram -->
                <div
                    class="bg-gradient-to-br from-pink-50 to-purple-50 dark:from-gray-800 dark:to-gray-900 p-6 rounded-2xl mb-6">
                    <h3 class="font-bold mb-4 text-center">Sinkhorn Generative Architecture</h3>
                    <svg width="100%" height="400" viewBox="0 0 700 400">
                        <!-- Input noise -->
                        <rect x="20" y="180" width="80" height="40" rx="5" fill="#a78bfa" />
                        <text x="60" y="205" text-anchor="middle" fill="white" font-size="12" font-weight="bold">z ~
                            N(0,1)</text>

                        <!-- Generator -->
                        <rect x="140" y="160" width="100" height="80" rx="10" fill="#ec4899" />
                        <text x="190" y="195" text-anchor="middle" fill="white" font-size="14"
                            font-weight="bold">Generator</text>
                        <text x="190" y="215" text-anchor="middle" fill="white" font-size="10">G_Œ∏</text>

                        <!-- Generated samples -->
                        <rect x="280" y="180" width="80" height="40" rx="5" fill="#ef4444" />
                        <text x="320" y="205" text-anchor="middle" fill="white" font-size="11"
                            font-weight="bold">{x‚ÇÅ,...,x‚Çò}</text>

                        <!-- Real samples -->
                        <rect x="280" y="80" width="80" height="40" rx="5" fill="#10b981" />
                        <text x="320" y="105" text-anchor="middle" fill="white" font-size="11"
                            font-weight="bold">{y‚ÇÅ,...,y‚Çô}</text>

                        <!-- Cost Matrix -->
                        <rect x="400" y="130" width="80" height="80" rx="5" fill="#6366f1" />
                        <text x="440" y="165" text-anchor="middle" fill="white" font-size="12" font-weight="bold">Cost
                            C</text>
                        <text x="440" y="182" text-anchor="middle" fill="white" font-size="9">c(x·µ¢,y‚±º)</text>

                        <!-- Sinkhorn -->
                        <rect x="520" y="130" width="80" height="80" rx="10" fill="#f59e0b" />
                        <text x="560" y="160" text-anchor="middle" fill="white" font-size="12"
                            font-weight="bold">Sinkhorn</text>
                        <text x="560" y="175" text-anchor="middle" fill="white" font-size="9">L iterations</text>
                        <text x="560" y="190" text-anchor="middle" fill="white" font-size="9">u, v</text>

                        <!-- Loss -->
                        <rect x="640" y="150" width="50" height="40" rx="5" fill="#be123c" />
                        <text x="665" y="175" text-anchor="middle" fill="white" font-size="11"
                            font-weight="bold">Loss</text>

                        <!-- Arrows -->
                        <path d="M 100 200 L 140 200" stroke="#94a3b8" stroke-width="3" marker-end="url(#arrow2)" />
                        <path d="M 240 200 L 280 200" stroke="#94a3b8" stroke-width="3" marker-end="url(#arrow2)" />
                        <path d="M 320 120 L 320 130 L 400 150" stroke="#94a3b8" stroke-width="3"
                            marker-end="url(#arrow2)" />
                        <path d="M 320 180 L 320 170 L 400 170" stroke="#94a3b8" stroke-width="3"
                            marker-end="url(#arrow2)" />
                        <path d="M 480 170 L 520 170" stroke="#94a3b8" stroke-width="3" marker-end="url(#arrow2)" />
                        <path d="M 600 170 L 640 170" stroke="#94a3b8" stroke-width="3" marker-end="url(#arrow2)" />

                        <!-- Backward gradient -->
                        <path d="M 665 150 L 665 50 L 190 50 L 190 160" stroke="#ef4444" stroke-width="2"
                            stroke-dasharray="5,5" marker-end="url(#arrow3)" />
                        <text x="400" y="40" text-anchor="middle" fill="#ef4444" font-size="10" font-weight="bold">‚àáŒ∏
                            Loss ‚Üí Update Œ∏</text>

                        <defs>
                            <marker id="arrow2" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                                <polygon points="0 0, 10 3, 0 6" fill="#94a3b8" />
                            </marker>
                            <marker id="arrow3" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                                <polygon points="0 0, 10 3, 0 6" fill="#ef4444" />
                            </marker>
                        </defs>
                    </svg>
                    <p class="text-xs text-center text-gray-600 dark:text-gray-400 mt-4">
                        Generator produces samples ‚Üí Compare to real data via Sinkhorn ‚Üí Backprop loss to update Œ∏
                    </p>
                </div>

                <!-- Algorithm -->
                <div
                    class="bg-gradient-to-br from-purple-50 to-pink-50 dark:from-gray-800 dark:to-gray-900 p-6 rounded-2xl">
                    <h3 class="font-bold mb-4 text-center">Algorithm: Sinkhorn Generative Modeling</h3>
                    <div class="space-y-2 font-mono text-xs bg-white dark:bg-gray-900 p-4 rounded-lg">
                        <p><span class="text-pink-600">Input:</span> Real samples, prior $p_z(z)$, iterations $N$,
                            regularization $\epsilon$, learning rate $\alpha$</p>
                        <p><span class="text-pink-600">1:</span> Initialize generator parameters $\theta$ randomly</p>
                        <p><span class="text-pink-600">2:</span> <span class="text-purple-600">for</span> $k=1$ to $N$:
                        </p>
                        <p class="ml-4"><span class="text-pink-600">3:</span> Sample mini-batch $\{y^i\}_{i=1}^n$ from
                            real data</p>
                        <p class="ml-4"><span class="text-pink-600">4:</span> Sample $\{z^i\}_{i=1}^m$ from $p_z(z)$</p>
                        <p class="ml-4"><span class="text-pink-600">5:</span> Generate $\{x^i\}_{i=1}^m$ via $x^i =
                            G_\theta(z^i)$</p>
                        <p class="ml-4"><span class="text-pink-600">6:</span> Compute cost matrix $C$ with $C_{ij} =
                            c(x^i, y^j)$</p>
                        <p class="ml-4"><span class="text-pink-600">7:</span> Run Sinkhorn to get $(u, v)$</p>
                        <p class="ml-4"><span class="text-pink-600">8:</span> Compute loss: $\hat{E}_L(\theta) = \langle
                            (C \odot K)^T v_L, u_L \rangle$</p>
                        <p class="ml-4"><span class="text-pink-600">9:</span> Update: $\theta \leftarrow \theta - \alpha
                            \nabla_\theta \hat{E}_L(\theta)$</p>
                    </div>
                    <div class="mt-4 p-3 bg-blue-50 dark:bg-gray-800 rounded-lg border-l-4 border-blue-400">
                        <p class="text-xs font-semibold">üí° Key Insight: Loss is differentiable w.r.t. Œ∏ through the
                            generated samples x!</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Summary -->
        <section class="glass p-8 rounded-3xl" data-aos="fade-up">
            <div class="flex items-center gap-3 mb-4">
                <span class="bg-pink-100 text-pink-700 p-2 rounded-xl">üìù</span>
                <h2 class="text-2xl font-bold">Key Takeaways</h2>
            </div>
            <div class="grid md:grid-cols-3 gap-4">
                <div
                    class="p-4 rounded-xl bg-gradient-to-br from-blue-50 to-cyan-50 dark:from-gray-800 dark:to-gray-900 border border-blue-200">
                    <h3 class="font-bold mb-2">üöö OT Basics</h3>
                    <p class="text-sm">Optimal transport finds minimum-cost coupling between distributions</p>
                </div>
                <div
                    class="p-4 rounded-xl bg-gradient-to-br from-purple-50 to-pink-50 dark:from-gray-800 dark:to-gray-900 border border-purple-200">
                    <h3 class="font-bold mb-2">‚ö° Sinkhorn</h3>
                    <p class="text-sm">Entropy regularization enables fast O(Lnm) matrix scaling algorithm</p>
                </div>
                <div
                    class="p-4 rounded-xl bg-gradient-to-br from-green-50 to-emerald-50 dark:from-gray-800 dark:to-gray-900 border border-green-200">
                    <h3 class="font-bold mb-2">üé® Generation</h3>
                    <p class="text-sm">Use OT distance as differentiable loss for training generators</p>
                </div>
            </div>
        </section>

        <section class="text-center" data-aos="fade-up">
            <p class="text-xl text-pink-700 dark:text-pink-300 italic">"From earth moving to pixel pushing‚Äîoptimal
                transport for generative AI!"</p>
        </section>
    </main>

    <script>
        AOS.init();
        window.addEventListener('scroll', () => {
            const docHeight = document.documentElement.scrollHeight - window.innerHeight;
            const scrolled = (window.scrollY / docHeight) * 100;
            document.getElementById('progress-bar').style.width = `${scrolled}%`;
        });

        function markQuiz1(button, isCorrect) {
            document.querySelectorAll('.quiz-option').forEach(btn => btn.classList.remove('correct', 'wrong'));
            if (isCorrect) {
                button.classList.add('correct');
                document.getElementById('quiz1-feedback').textContent = '‚úì Correct! Row sums matching p ensures mass conservation from source distribution.';
            } else {
                button.classList.add('wrong');
                document.getElementById('quiz1-feedback').textContent = '‚úó Not quite. Think about what summing across columns (¬∑1‚Çò) does.';
            }
        }

        function resetQuiz1() {
            document.querySelectorAll('.quiz-option').forEach(btn => btn.classList.remove('correct', 'wrong'));
            document.getElementById('quiz1-feedback').textContent = '';
        }

        function markQuiz2(button, isCorrect) {
            document.querySelectorAll('.quiz-option').forEach(btn => btn.classList.remove('correct', 'wrong'));
            if (isCorrect) {
                button.classList.add('correct');
                document.getElementById('quiz2-feedback').textContent = '‚úì Excellent! The transport plan œÄ has continuous/fractional entries, not discrete assignments.';
            } else {
                button.classList.add('wrong');
                document.getElementById('quiz2-feedback').textContent = '‚úó That statement is actually correct. Look for the FALSE one!';
            }
        }

        function resetQuiz2() {
            document.querySelectorAll('.quiz-option').forEach(btn => btn.classList.remove('correct', 'wrong'));
            document.getElementById('quiz2-feedback').textContent = '';
        }
    </script>
</body>

</html>