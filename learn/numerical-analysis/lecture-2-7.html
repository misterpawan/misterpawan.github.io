<!DOCTYPE html>
<html lang="en" class="scroll-smooth">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lecture 2-7: Random Numbers - Complete Course</title>

    <script src="https://cdn.tailwindcss.com"></script>

    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>

    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>

    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        ntu: {
                            red: '#e11d48',
                            dark: '#0f172a',
                            code: '#282c34',
                        }
                    },
                    fontFamily: {
                        sans: ['Segoe UI', 'sans-serif'],
                        mono: ['Consolas', 'Monaco', 'monospace'],
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #f8fafc;
            color: #334155;
        }

        .slide-card {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 3rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            border: 1px solid #e2e8f0;
        }

        .code-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0;
            background: #282c34;
            border-radius: 8px;
            overflow: hidden;
            margin: 1rem 0;
            min-height: 300px;
        }

        @media (max-width: 768px) {
            .code-container {
                grid-template-columns: 1fr;
            }
        }

        .code-editor {
            padding: 1rem;
            color: #abb2bf;
            font-size: 0.85rem;
            overflow-x: auto;
            border-right: 1px solid #3e4451;
            position: relative;
        }

        .output-panel {
            padding: 1rem;
            background: #21252b;
            color: #98c379;
            font-family: 'Consolas', monospace;
            font-size: 0.85rem;
            overflow-y: auto;
            max-height: 400px;
            position: relative;
        }

        .run-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #e11d48;
            color: white;
            padding: 4px 12px;
            border-radius: 4px;
            font-size: 0.75rem;
            cursor: pointer;
            z-index: 10;
            font-weight: bold;
            border: none;
        }

        .run-btn:hover {
            background: #be123c;
        }

        .math-box {
            background: #f1f5f9;
            border-left: 4px solid #e11d48;
            padding: 1rem;
            margin: 1rem 0;
            overflow-x: auto;
        }
    </style>
</head>

<body>

    <nav class="sticky top-0 z-50 bg-white/90 backdrop-blur-md border-b border-gray-200 shadow-sm">
        <div class="max-w-7xl mx-auto px-4 py-3 flex justify-between items-center">
            <span class="font-bold text-xl text-slate-800">Numerical Analysis <span
                    class="text-ntu-red">2-7</span></span>
            <div class="hidden md:flex space-x-1 text-sm font-medium text-slate-600">
                <a href="#intro" class="px-3 py-1 hover:bg-gray-100 rounded">Intro</a>
                <a href="#lcg" class="px-3 py-1 hover:bg-gray-100 rounded">LCG</a>
                <a href="#bitwise" class="px-3 py-1 hover:bg-gray-100 rounded">Bitwise</a>
                <a href="#dist" class="px-3 py-1 hover:bg-gray-100 rounded">Distributions</a>
                <a href="#monte-carlo" class="px-3 py-1 hover:bg-gray-100 rounded">Monte Carlo</a>
                <a href="#hands-on" class="px-3 py-1 bg-ntu-red text-white rounded shadow-sm">Hands On</a>
            </div>
        </div>
    </nav>

    <header class="pt-24 pb-16 text-center px-4 bg-gradient-to-b from-rose-50 to-transparent">
        <h1 class="text-5xl md:text-6xl font-extrabold text-slate-900 mb-6 tracking-tight">
            Random Numbers üé≤
        </h1>
        <p class="text-xl text-slate-600 max-w-2xl mx-auto mb-8">
            Generating "randomness" with deterministic machines. <br>
            <span class="text-sm text-ntu-red font-mono">Lecture 2-7 ‚Ä¢ Kai-Feng Chen ‚Ä¢ NTU</span>
        </p>
    </header>

    <main class="max-w-6xl mx-auto px-4 pb-20">

        <section id="intro" class="slide-card">
            <h2 class="text-3xl font-bold text-slate-800 mb-6 flex items-center gap-2">
                <span>1. Old-Fashioned Randomness</span>
                <span class="text-2xl">‚úèÔ∏è</span>
            </h2>

            <div class="grid md:grid-cols-2 gap-8 mb-8">
                <div>
                    <div class="bg-gray-100 p-4 rounded-lg text-center mb-4">
                        <div class="text-4xl mb-2">üé≤</div>
                        <p class="font-bold">The Pencil Method</p>
                        <p class="text-xs text-gray-500">Roll a pencil with A, B, C, D sides.</p>
                    </div>
                    [cite_start]<p class="text-sm text-slate-600">Great for exams, bad for simulation (too slow, not
                        enough digits). [cite: 3737-3743]</p>
                </div>
                <div>
                    <div
                        class="bg-gray-100 p-4 rounded-lg text-center mb-4 font-mono text-xs overflow-hidden h-32 leading-relaxed text-gray-500">
                        1234 5678 9012 3456<br>
                        8094 2525 8247 1347<br>
                        3563 2198 8211 9045<br>
                        ... (Random Number Tables)
                    </div>
                    <p class="text-sm text-slate-600">Old Random Number Tables taught us two things:
                    <ol class="list-decimal ml-5 mt-2 font-bold">
                        <li>You need a seed.</li>
                        <li>It's recursive.</li>
                    </ol>
                    </p>
                </div>
            </div>
        </section>

        <section id="lcg" class="slide-card">
            <h2 class="text-3xl font-bold text-slate-800 mb-6">2. Linear Congruential Generator (LCG)</h2>

            <div class="math-box text-center text-xl">
                $$ R_{next} = (a \cdot R_{current} + c) \mod M $$
            </div>
            <p class="text-center text-sm text-gray-500 mb-8">The most classical (and often bad) algorithm.</p>

            <div class="mb-8">
                <h3 class="font-bold text-lg mb-2 text-red-600">Example 1: A Bad LCG (M=100)</h3>
                <p class="text-sm mb-2">Notice how quickly the pattern repeats.</p>
                <div class="code-container">
                    <div class="code-editor">
                        <button class="run-btn" onclick="runLCG()">‚ñ∂ Run Code</button>
                        <pre><code class="language-python"># 1207-example-01.py
class rnd:
    def __init__(self, s=1234):
        self.seed = s
        
    def gen(self):
        # a=32533521, c=2424, M=100
        self.seed = (32533521*self.seed + 2424) % 100
        return self.seed

r = rnd()
print("First 30 numbers:")
for i in range(30):
    print(r.gen(), end=' ')</code></pre>
                    </div>
                    <div id="out-lcg" class="output-panel">Click Run to execute...</div>
                </div>
            </div>

            <div class="mb-8">
                <h3 class="font-bold text-lg mb-2 text-blue-600">Example 2: Park-Miller LCG (Good)</h3>
                <p class="text-sm mb-2">Using $M = 2^{31}-1$. Much better period.</p>
                <div class="code-container">
                    <div class="code-editor">
                        <button class="run-btn" onclick="runParkMiller()">‚ñ∂ Run Code</button>
                        <pre><code class="language-python"># 1207-example-01a.py
class rnd:
    def __init__(self, s=1234):
        self.seed = s
        
    def gen(self):
        # Park-Miller constants
        self.seed = (16807*self.seed) % (2**31-1)
        return self.seed

r = rnd()
for i in range(30):
    print(r.gen(), end=' ')</code></pre>
                    </div>
                    <div id="out-pm" class="output-panel">Click Run to execute...</div>
                </div>
            </div>

            <div>
                <h3 class="font-bold text-lg mb-2">Example 3: Visualizing Uniformity</h3>
                <p class="text-sm mb-2">Let's plot 100,000 numbers from the Park-Miller generator.</p>
                <div class="grid lg:grid-cols-2 gap-4">
                    <div class="code-container m-0">
                        <div class="code-editor">
                            <button class="run-btn" onclick="runPMHist()">‚ñ∂ Run & Plot</button>
                            <pre><code class="language-python"># 1207-example-01b.py
class rnd:
    def __init__(self, s=1234):
        self.seed = s
    def gen(self):
        self.seed = (16807*self.seed) % (2**31-1)
        return self.seed
    def random(self):
        return float(self.gen())/(2**31-1)

r = rnd()     
data = np.zeros(100000)
for i in range(len(data)):
    data[i] = r.random()
    
plt.hist(data, bins=50) # Plotting...</code></pre>
                        </div>
                    </div>
                    <div id="plot-pm" class="border bg-white rounded flex items-center justify-center">
                        <span class="text-gray-400 text-sm">Plot will appear here</span>
                    </div>
                </div>
            </div>
        </section>

        <section id="bitwise" class="slide-card">
            <h2 class="text-3xl font-bold text-slate-800 mb-6">3. Bitwise Magic üßô‚Äç‚ôÇÔ∏è</h2>

            <div id="bitwise-tabs-root"></div>

            <div class="mt-8 mb-8">
                <h3 class="font-bold text-lg mb-2 text-indigo-600">XORSHIFT Algorithm</h3>
                <div class="code-container">
                    <div class="code-editor">
                        <button class="run-btn" onclick="runXorShift()">‚ñ∂ Run Code</button>
                        <pre><code class="language-python"># 1207-example-02.py
class rnd:
    def __init__(self, s=1234):
        self.seed = s
                
    def gen(self):
        # 3 XOR-SHIFT operations
        self.seed = self.seed ^ (self.seed >> 21)
        self.seed = self.seed ^ (self.seed << 35)
        self.seed = self.seed ^ (self.seed >>  4)
        # Keep it 64-bit integer behavior in Python
        return (self.seed & 0xffffffff)

r = rnd()
for i in range(30):
    print(r.gen(), end=' ')</code></pre>
                    </div>
                    <div id="out-xor" class="output-panel">Click Run to execute...</div>
                </div>
            </div>

            <div class="mb-8">
                <h3 class="font-bold text-lg mb-2 text-indigo-600">Multiply With Carry (MWC)</h3>
                <div class="code-container">
                    <div class="code-editor">
                        <button class="run-btn" onclick="runMWC()">‚ñ∂ Run Code</button>
                        <pre><code class="language-python"># 1207-example-03.py
class rnd:
    def __init__(self, s=1234):
        self.seed = s
    
    def gen(self):
        # High/Low bit manipulation
        self.seed = \
        (self.seed & 0xffffffff)*4294957665 + (self.seed>>32)
        return (self.seed & 0xffffffff)

r = rnd()
for i in range(30):
    print(r.gen(), end=' ')</code></pre>
                    </div>
                    <div id="out-mwc" class="output-panel">Click Run to execute...</div>
                </div>
            </div>

            <div class="mb-8">
                <h3 class="font-bold text-lg mb-2 text-indigo-600">Combined Generator (Strongest)</h3>
                <p class="text-sm mb-2">Combining XORSHIFT and MWC. Period $\approx 10^{37}$.</p>
                <div class="code-container">
                    <div class="code-editor">
                        <button class="run-btn" onclick="runCombined()">‚ñ∂ Run Code</button>
                        <pre><code class="language-python"># 1207-example-04 (1).py
class rnd:
    def __init__(self, s1=1234, s2=5678):
        self.s1, self.s2 = s1, s2
                
    def gen(self):        
        # XORSHIFT part
        self.s1 ^= (self.s1 >> 17)
        self.s1 ^= (self.s1 << 31)
        self.s1 ^= (self.s1 >>  8)
        # MWC part
        self.s2 = (self.s2 & 0xffffffff)*4294957665 + (self.s2>>32)
        # Combine
        return ((self.s1 ^ self.s2) & 0xffffffff)
	
r = rnd()
for i in range(30):
    print(r.gen(), end=' ')</code></pre>
                    </div>
                    <div id="out-comb" class="output-panel">Click Run to execute...</div>
                </div>
            </div>
        </section>

        <section id="dist" class="slide-card">
            <h2 class="text-3xl font-bold text-slate-800 mb-6">4. Non-Uniform Distributions üìä</h2>
            <p class="mb-4 text-slate-600">How to turn a flat distribution into shapes?</p>

            <div class="mb-8 border-l-4 border-red-500 pl-4">
                <h3 class="font-bold text-lg mb-2 text-red-600">The Wrong Way</h3>
                <p class="text-sm mb-2">Just plugging random numbers into $f(x)$ does <strong>not</strong> produce
                    distribution $f(x)$.</p>
                <div class="grid lg:grid-cols-2 gap-4">
                    <div class="code-container m-0">
                        <div class="code-editor">
                            <button class="run-btn" onclick="runWrong()">‚ñ∂ Run & Plot</button>
                            <pre><code class="language-python"># 1207-example-05.py
def f(x):
    return x # y = x
    
# If y = x, output is just x!
x = np.random.rand(100000)
data = f(x)

plt.hist(data, bins=50) # Still flat!</code></pre>
                        </div>
                    </div>
                    <div id="plot-wrong" class="border bg-white rounded h-[300px]"></div>
                </div>
            </div>

            <div class="grid md:grid-cols-3 gap-4 mb-8">
                <div class="bg-blue-50 p-4 rounded text-center">
                    <div class="font-bold text-blue-800 mb-1">Hit-or-Miss</div>
                    <p class="text-xs">Accept $x$ if $y < f(x)$. Simple but inefficient.</p>
                </div>
                <div class="bg-green-50 p-4 rounded text-center">
                    <div class="font-bold text-green-800 mb-1">Inverse Transform</div>
                    <p class="text-xs">$x = W^{-1}(r)$. Exact and fast.</p>
                </div>
                <div class="bg-purple-50 p-4 rounded text-center">
                    <div class="font-bold text-purple-800 mb-1">CLT Summation</div>
                    <p class="text-xs">Add many uniform numbers $\rightarrow$ Gaussian.</p>
                </div>
            </div>

            <div class="mb-8">
                <h3 class="font-bold text-lg mb-2">Hit-or-Miss Method</h3>
                <p class="text-sm mb-2">Generating distribution for $f(x) = x - x^2 + x^3 - x^4 + \sin(13x)/13$.</p>
                <div class="grid lg:grid-cols-2 gap-4">
                    <div class="code-container m-0">
                        <div class="code-editor">
                            <button class="run-btn" onclick="runHitMiss()">‚ñ∂ Run & Plot</button>
                            <pre><code class="language-python"># 1207-example-06.py
def f(x):
    return x - x**2 + x**3 - x**4 + np.sin(x*13.)/13.
    
x = np.random.rand(20000)
y = np.random.rand(20000)*0.45

# Pythonic filtering
data = x[y < f(x)]

plt.hist(data, bins=50)</code></pre>
                        </div>
                    </div>
                    <div id="plot-hitmiss" class="border bg-white rounded h-[300px]"></div>
                </div>
            </div>

            <div class="mb-8">
                <h3 class="font-bold text-lg mb-2">Inverse Transform Method</h3>
                <div class="grid lg:grid-cols-2 gap-4">
                    <div class="code-container m-0">
                        <div class="code-editor">
                            <button class="run-btn" onclick="runInverse()">‚ñ∂ Run & Plot</button>
                            <pre><code class="language-python"># 1207-example-07.py
# f(x) = exp(-x) on [0, 1]
# Inverse CDF: x = -ln(1 - r + r/e)

r = np.random.rand(10000)
data = -np.log(1. - r + r/np.exp(1.))

plt.hist(data, bins=50)</code></pre>
                        </div>
                    </div>
                    <div id="plot-inverse" class="border bg-white rounded h-[300px]"></div>
                </div>
            </div>

            <div class="mb-8">
                <h3 class="font-bold text-lg mb-2">Gaussian via Central Limit Theorem</h3>
                <p class="text-sm mb-2">Adding 6 uniform random numbers approximates a Normal distribution.</p>
                <div class="grid lg:grid-cols-2 gap-4">
                    <div class="code-container m-0">
                        <div class="code-editor">
                            <button class="run-btn" onclick="runCLT()">‚ñ∂ Run & Plot</button>
                            <pre><code class="language-python"># 1207-example-08a.py
r = np.random.rand(10000)
# Add 5 more random arrays
for _ in range(5):
    r += np.random.rand(10000)

plt.hist(r, bins=50, range=(0., 6.))</code></pre>
                        </div>
                    </div>
                    <div id="plot-clt" class="border bg-white rounded h-[300px]"></div>
                </div>
            </div>
        </section>

        <section id="monte-carlo" class="slide-card bg-slate-900 text-white">
            <h2 class="text-3xl font-bold mb-6 text-white border-b border-gray-700 pb-2">5. Monte Carlo Integration üé≤
            </h2>
            <p class="mb-6 text-gray-300">
                Solving high-dimensional integrals where grid methods fail.
                <br>
                $$ I \approx (b-a) \langle f \rangle = \frac{V}{N} \sum f(x_i) $$
            </p>

            <div class="grid md:grid-cols-2 gap-8">
                <div>
                    <h4 class="font-bold text-blue-400 mb-2">6D Integral Example</h4>
                    <div class="code-container m-0 bg-black">
                        <div class="code-editor text-xs">
                            <button class="run-btn" onclick="runMC()">‚ñ∂ Run MC</button>
                            <pre><code class="language-python"># 1207-example-09.py
# Integrate sum of trig functions over 6D cube

nsamples = 1000000
v = np.random.rand(nsamples, 6)

# f = sin(a) + sin(2b) + ...
val = func(v[:,0], ..., v[:,5])

intf_rand = val.sum() / nsamples
print(f"MC Result: {intf_rand:.5f}")</code></pre>
                        </div>
                    </div>
                </div>
                <div class="flex flex-col justify-center">
                    <div id="out-mc" class="bg-gray-800 p-4 rounded text-sm font-mono text-green-400 min-h-[150px]">
                        Click run to start Monte Carlo simulation...
                    </div>
                </div>
            </div>
        </section>

        <section id="hands-on" class="slide-card bg-gradient-to-br from-red-50 to-orange-50 border-red-100">
            <h2 class="text-3xl font-bold text-red-900 mb-6 flex items-center gap-3">
                <span>üëê</span> Hands-On Session
            </h2>
            <p class="mb-6 text-red-800">Use the methods above to solve these problems.</p>

            <div class="grid md:grid-cols-2 gap-8">
                <div class="bg-white p-6 rounded-lg shadow-sm">
                    <h3 class="font-bold text-lg text-red-800 mb-2">Practice 1: Step Function</h3>
                    <p class="text-sm text-gray-600 mb-4">Generate distribution for:</p>
                    <div class="math-box text-xs bg-gray-50">
                        f(x) = 1 (0 < x <=1)<br>
                            f(x) = 2 (1 < x <=2)<br>
                                ...<br>
                                f(x) = 9 (8 < x <=9) </div>
                    </div>

                    <div class="bg-white p-6 rounded-lg shadow-sm">
                        <h3 class="font-bold text-lg text-orange-800 mb-2">Practice 2: Complex Model</h3>
                        <p class="text-sm text-gray-600 mb-4">Generate 10k events for the Higgs fit model:</p>
                        <div class="math-box text-xs bg-gray-50">
                            $$ f(x) = \text{Gaussian} + ax^2 + bx + c $$
                        </div>
                    </div>
                </div>
        </section>

    </main>

    <footer class="bg-white border-t py-12 text-center text-sm text-gray-400 mt-12">
        <p>Numerical Analysis Lecture 2-7 ‚Ä¢ Kai-Feng Chen ‚Ä¢ National Taiwan University</p>
    </footer>

    <script>
        // --- HELPERS ---
        function printTo(id, text, append = true) {
            const el = document.getElementById(id);
            if (!append) el.innerHTML = '';
            el.innerHTML += text + '<br>';
            el.scrollTop = el.scrollHeight;
        }

        // --- LCG Logic ---
        function runLCG() {
            let seed = 1234;
            let out = "";
            for (let i = 0; i < 30; i++) {
                seed = (32533521 * seed + 2424) % 100;
                out += seed + ", ";
            }
            printTo('out-lcg', "Sequence: <br>" + out + "...", false);
        }

        function runParkMiller() {
            let seed = 1234;
            const M = 2147483647; // 2^31 - 1
            let out = "";
            for (let i = 0; i < 30; i++) {
                seed = (16807 * seed) % M;
                out += seed + ", ";
            }
            printTo('out-pm', "Sequence: <br>" + out + "...", false);
        }

        function runPMHist() {
            let seed = 1234;
            const M = 2147483647;
            const data = [];
            for (let i = 0; i < 100000; i++) {
                seed = (16807 * seed) % M;
                data.push(seed / M);
            }
            const trace = { x: data, type: 'histogram', marker: { color: '#eab308' } };
            Plotly.newPlot('plot-pm', [trace], { margin: { t: 10, b: 20, l: 30, r: 10 }, title: 'Uniform Distribution' });
        }

        // --- Bitwise Logic ---
        function runXorShift() {
            let seed = 1234n; // BigInt for 64bit safety logic simulation
            let out = "";
            for (let i = 0; i < 30; i++) {
                seed ^= (seed >> 21n);
                seed ^= (seed << 35n);
                seed ^= (seed >> 4n);
                // Simulate 32-bit unsigned return
                let val = Number(seed & 0xffffffffn);
                out += val + ", ";
            }
            printTo('out-xor', "Sequence: <br>" + out + "...", false);
        }

        function runMWC() {
            let seed = 1234n;
            let out = "";
            const a = 4294957665n;
            for (let i = 0; i < 30; i++) {
                seed = (seed & 0xffffffffn) * a + (seed >> 32n);
                let val = Number(seed & 0xffffffffn);
                out += val + ", ";
            }
            printTo('out-mwc', "Sequence: <br>" + out + "...", false);
        }

        function runCombined() {
            let s1 = 1234n, s2 = 5678n;
            const a = 4294957665n;
            let out = "";
            for (let i = 0; i < 30; i++) {
                // XORSHIFT
                s1 ^= (s1 >> 17n); s1 ^= (s1 << 31n); s1 ^= (s1 >> 8n);
                // MWC
                s2 = (s2 & 0xffffffffn) * a + (s2 >> 32n);
                let val = Number((s1 ^ s2) & 0xffffffffn);
                out += val + ", ";
            }
            printTo('out-comb', "Sequence: <br>" + out + "...", false);
        }

        // --- Distributions ---
        function runWrong() {
            // f(x) = x
            const data = [];
            for (let i = 0; i < 10000; i++) data.push(Math.random());
            const trace = { x: data, type: 'histogram', marker: { color: '#eab308' } };
            Plotly.newPlot('plot-wrong', [trace], { margin: { t: 10, b: 20, l: 30, r: 10 }, title: 'Naive (Wrong) Transform' });
        }

        function runHitMiss() {
            // f(x) = x - x^2 + x^3 - x^4 + sin(13x)/13
            const f = (x) => x - x * x + x * x * x - Math.pow(x, 4) + Math.sin(x * 13) / 13;
            const data = [];
            // Generate 20000 points
            for (let i = 0; i < 20000; i++) {
                let x = Math.random();
                let y = Math.random() * 0.45; // Max bound
                if (y < f(x)) data.push(x);
            }
            const trace = { x: data, type: 'histogram', marker: { color: '#eab308' } };
            Plotly.newPlot('plot-hitmiss', [trace], { margin: { t: 10, b: 20, l: 30, r: 10 }, title: 'Hit-or-Miss Distribution' });
        }

        function runInverse() {
            // f(x) = exp(-x), x = -ln(1-r+r/e)
            const data = [];
            const e = Math.exp(1);
            for (let i = 0; i < 10000; i++) {
                let r = Math.random();
                data.push(-Math.log(1 - r + r / e));
            }
            const trace = { x: data, type: 'histogram', marker: { color: '#eab308' } };
            Plotly.newPlot('plot-inverse', [trace], { margin: { t: 10, b: 20, l: 30, r: 10 }, title: 'Exponential Dist.' });
        }

        function runCLT() {
            const data = new Array(10000).fill(0);
            for (let k = 0; k < 6; k++) {
                for (let i = 0; i < 10000; i++) data[i] += Math.random();
            }
            const trace = { x: data, type: 'histogram', marker: { color: '#eab308' } };
            Plotly.newPlot('plot-clt', [trace], { margin: { t: 10, b: 20, l: 30, r: 10 }, title: 'Gaussian via CLT' });
        }

        // --- Monte Carlo ---
        function runMC() {
            const n = 1000000;
            let sum = 0;
            // Exact solution pre-calculated
            const exact = 3.17426;

            // Simulating part of the calc to save browser freeze
            const batch = 10000;
            for (let i = 0; i < batch; i++) {
                let a = Math.random(), b = Math.random(), c = Math.random();
                let d = Math.random(), e = Math.random(), f = Math.random();
                // f = sin(a)+sin(2b)+sin(3c)+cos(d)+cos(2e)+cos(3f)
                sum += Math.sin(a) + Math.sin(2 * b) + Math.sin(3 * c) +
                    Math.cos(d) + Math.cos(2 * e) + Math.cos(3 * f);
            }
            // Scale up for demo
            let avg = sum / batch;

            printTo('out-mc', `Exact:  ${exact}`, false);
            printTo('out-mc', `Random: ${avg.toFixed(5)} (Simulated small batch)`, true);
            printTo('out-mc', `Diff:   ${(avg - exact).toFixed(5)}`, true);
        }

        // Highlight Code & Math
        document.addEventListener("DOMContentLoaded", function () {
            hljs.highlightAll();
            renderMathInElement(document.body, {
                delimiters: [
                    { left: "$$", right: "$$", display: true },
                    { left: "$", right: "$", display: false }
                ]
            });
        });
    </script>
</body>

</html>