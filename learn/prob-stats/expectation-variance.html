<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Expectation & Variance - Probability & Statistics</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0f172a;
            color: #e2e8f0;
        }

        .glass-panel {
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 1rem;
        }

        .interactive-card {
            transition: all 0.3s ease;
        }

        .interactive-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.3);
            border-color: rgba(99, 102, 241, 0.4);
        }

        .draggable-point {
            cursor: grab;
        }

        .draggable-point:active {
            cursor: grabbing;
        }
    </style>
</head>

<body class="min-h-screen selection:bg-indigo-500 selection:text-white">

    <!-- Navigation -->
    <nav class="fixed w-full z-50 glass-panel border-b border-white/10">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center space-x-3">
                    <a href="index.html"
                        class="text-xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-indigo-400 to-cyan-400">
                        ProbStats
                    </a>
                    <span class="text-slate-500">/</span>
                    <span class="text-slate-300 font-medium">Unit 3: Expectation & Variance</span>
                </div>
                <div class="hidden md:flex items-center space-x-8">
                    <a href="index.html"
                        class="text-sm font-medium text-slate-400 hover:text-indigo-400 transition-colors">Home</a>
                    <a href="discrete-distributions.html"
                        class="text-sm font-medium text-slate-400 hover:text-indigo-400 transition-colors">Prev:
                        Discrete Dist</a>
                    <a href="continuous-random-variables.html"
                        class="text-sm font-medium text-indigo-400 hover:text-indigo-300 transition-colors">Next:
                        Continuous RVs</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="pt-32 pb-20 px-4 relative overflow-hidden">
        <div
            class="absolute top-0 left-1/2 -translate-x-1/2 w-full h-full bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-indigo-900/20 via-slate-900/0 to-slate-900/0 pointer-events-none">
        </div>

        <div class="max-w-4xl mx-auto text-center relative z-10">
            <h1
                class="text-5xl md:text-6xl font-bold mb-6 bg-clip-text text-transparent bg-gradient-to-r from-white to-slate-400">
                Expectation & Variance
            </h1>
            <p class="text-xl text-slate-400 leading-relaxed max-w-2xl mx-auto">
                Understanding the center and spread of data. The two most important numbers in statistics.
            </p>
        </div>
    </section>

    <!-- Main Content -->
    <main class="max-w-4xl mx-auto px-4 pb-24 space-y-16">

        <!-- Expectation Section -->
        <section class="glass-panel p-8 md:p-10">
            <h2 class="text-2xl font-bold text-white mb-6 text-indigo-300">1. Expectation (The Mean)</h2>
            <div class="prose prose-invert max-w-none text-slate-300 mb-8">
                <p>
                    The <strong>Expectation</strong>, or expected value, \( E[X] \), is the weighted average of all
                    possible values. It represents the "center of mass" of the distribution.
                </p>
                <div class="my-6 p-6 bg-slate-800/50 rounded-xl border border-slate-700/50 text-center">
                    $$ E[X] = \sum_{x} x \cdot P(X=x) $$
                </div>
            </div>

            <!-- Interactive Balancing Point -->
            <div class="bg-slate-900/50 rounded-xl p-6 border border-slate-700/50">
                <h3 class="text-lg font-semibold text-white mb-4">Visualizing the Mean as a Balance Point</h3>
                <p class="text-sm text-slate-400 mb-6">
                    Drag the weights (blue circles) along the number line. The fulcrum (triangle) moves to the center of
                    mass (the mean).
                </p>

                <div class="h-40 w-full relative bg-slate-800/30 rounded-lg select-none" id="balance-container">
                    <!-- Line -->
                    <div class="absolute top-1/2 left-4 right-4 h-1 bg-slate-600 rounded"></div>

                    <!-- Weights (Generated by JS) -->

                    <!-- Fulcrum -->
                    <div id="fulcrum"
                        class="absolute top-1/2 w-0 h-0 border-l-[10px] border-l-transparent border-r-[10px] border-r-transparent border-b-[20px] border-b-amber-500 transition-all duration-100"
                        style="transform: translateX(-50%); margin-top: 4px;"></div>
                    <div id="mean-label"
                        class="absolute top-1/2 mt-8 text-amber-500 font-mono text-sm font-bold transition-all duration-100"
                        style="transform: translateX(-50%);">Mean: 5.0</div>
                </div>
                <div class="flex justify-between px-4 mt-2 text-xs text-slate-500 font-mono">
                    <span>0</span><span>10</span>
                </div>
            </div>
        </section>

        <!-- Variance Section -->
        <section class="glass-panel p-8 md:p-10">
            <h2 class="text-2xl font-bold text-white mb-6 text-cyan-300">2. Variance & Standard Deviation</h2>
            <div class="prose prose-invert max-w-none text-slate-300 mb-8">
                <p>
                    <strong>Variance</strong> measures how spread out the data is. It is the average squared distance
                    from the mean.
                </p>
                <div class="grid md:grid-cols-2 gap-8 my-6">
                    <div class="bg-slate-800/50 p-6 rounded-xl border border-slate-700/50">
                        <h4 class="text-sm font-semibold text-slate-400 uppercase tracking-wider mb-2">Variance</h4>
                        $$ \text{Var}(X) = E[(X - \mu)^2] $$
                        $$ \text{Var}(X) = E[X^2] - (E[X])^2 $$
                    </div>
                    <div class="bg-slate-800/50 p-6 rounded-xl border border-slate-700/50">
                        <h4 class="text-sm font-semibold text-slate-400 uppercase tracking-wider mb-2">Standard
                            Deviation</h4>
                        $$ \sigma = \sqrt{\text{Var}(X)} $$
                        <p class="text-sm text-slate-400 mt-2">Same units as X!</p>
                    </div>
                </div>
            </div>

            <!-- Interactive Variance Visualizer -->
            <div class="bg-slate-900/50 rounded-xl p-6 border border-slate-700/50">
                <h3 class="text-lg font-semibold text-white mb-4">Visualizing Spread</h3>
                <p class="text-sm text-slate-400 mb-6">
                    Move the points. Notice how points further from the mean increase the variance much more than points
                    close to it (due to squaring).
                </p>

                <div class="h-48 w-full relative bg-slate-800/30 rounded-lg select-none" id="variance-container">
                    <!-- Mean Line -->
                    <div id="var-mean-line"
                        class="absolute top-0 bottom-0 w-0.5 bg-amber-500/50 border-dashed border-l border-amber-500">
                    </div>

                    <!-- Points (Generated by JS) -->
                </div>

                <div class="grid grid-cols-3 gap-4 mt-6 text-center">
                    <div class="p-3 bg-slate-800 rounded-lg">
                        <div class="text-xs text-slate-500 uppercase">Mean</div>
                        <div class="text-xl font-bold text-amber-500" id="var-mean-val">0.0</div>
                    </div>
                    <div class="p-3 bg-slate-800 rounded-lg">
                        <div class="text-xs text-slate-500 uppercase">Variance</div>
                        <div class="text-xl font-bold text-cyan-400" id="var-val">0.0</div>
                    </div>
                    <div class="p-3 bg-slate-800 rounded-lg">
                        <div class="text-xs text-slate-500 uppercase">Std Dev</div>
                        <div class="text-xl font-bold text-cyan-400" id="std-val">0.0</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Properties Section -->
        <section class="glass-panel p-8 md:p-10">
            <h2 class="text-2xl font-bold text-white mb-6 text-emerald-300">3. Key Properties</h2>
            <div class="grid md:grid-cols-2 gap-6">
                <div class="bg-slate-800/50 p-6 rounded-xl border border-slate-700/50">
                    <h3 class="text-lg font-semibold text-white mb-4">Linearity of Expectation</h3>
                    <p class="text-slate-400 text-sm mb-4">
                        Expectation is a linear operator. This is incredibly useful!
                    </p>
                    <div class="text-center p-4 bg-slate-900/50 rounded-lg font-mono text-sm text-emerald-400">
                        E[aX + b] = aE[X] + b
                    </div>
                    <div class="text-center p-4 bg-slate-900/50 rounded-lg font-mono text-sm text-emerald-400 mt-2">
                        E[X + Y] = E[X] + E[Y]
                    </div>
                </div>

                <div class="bg-slate-800/50 p-6 rounded-xl border border-slate-700/50">
                    <h3 class="text-lg font-semibold text-white mb-4">Properties of Variance</h3>
                    <p class="text-slate-400 text-sm mb-4">
                        Variance is NOT linear. Constants disappear, and scaling is squared.
                    </p>
                    <div class="text-center p-4 bg-slate-900/50 rounded-lg font-mono text-sm text-emerald-400">
                        Var(X + c) = Var(X)
                    </div>
                    <div class="text-center p-4 bg-slate-900/50 rounded-lg font-mono text-sm text-emerald-400 mt-2">
                        Var(aX) = aÂ²Var(X)
                    </div>
                </div>
            </div>
        </section>

    </main>

    <script>
        // --- Balancing Point Logic ---
        const balanceContainer = document.getElementById('balance-container');
        const fulcrum = document.getElementById('fulcrum');
        const meanLabel = document.getElementById('mean-label');

        let weights = [20, 50, 80]; // Initial positions (0-100 scale)

        function initBalance() {
            weights.forEach((pos, index) => {
                createWeight(pos, index);
            });
            updateBalance();
        }

        function createWeight(pos, index) {
            const el = document.createElement('div');
            el.className = 'absolute w-6 h-6 bg-indigo-500 rounded-full border-2 border-white shadow-lg cursor-grab active:cursor-grabbing hover:bg-indigo-400 transition-colors z-10';
            el.style.top = 'calc(50% - 12px)';
            el.style.left = `${pos}%`;
            el.style.transform = 'translate(-50%, -50%)';

            // Drag logic
            let isDragging = false;

            el.addEventListener('mousedown', (e) => {
                isDragging = true;
                document.body.style.userSelect = 'none';
            });

            window.addEventListener('mousemove', (e) => {
                if (!isDragging) return;
                const rect = balanceContainer.getBoundingClientRect();
                let x = e.clientX - rect.left;
                let percent = (x / rect.width) * 100;
                percent = Math.max(0, Math.min(100, percent));

                weights[index] = percent;
                el.style.left = `${percent}%`;
                updateBalance();
            });

            window.addEventListener('mouseup', () => {
                isDragging = false;
                document.body.style.userSelect = '';
            });

            balanceContainer.appendChild(el);
        }

        function updateBalance() {
            const mean = weights.reduce((a, b) => a + b, 0) / weights.length;
            fulcrum.style.left = `${mean}%`;
            meanLabel.style.left = `${mean}%`;
            meanLabel.textContent = `Mean: ${(mean / 10).toFixed(1)}`;
        }

        initBalance();


        // --- Variance Visualizer Logic ---
        const varContainer = document.getElementById('variance-container');
        const varMeanLine = document.getElementById('var-mean-line');
        const varMeanVal = document.getElementById('var-mean-val');
        const varVal = document.getElementById('var-val');
        const stdVal = document.getElementById('std-val');

        let points = [20, 40, 60, 80]; // Initial positions

        function initVariance() {
            points.forEach((pos, index) => {
                createVarPoint(pos, index);
            });
            updateVariance();
        }

        function createVarPoint(pos, index) {
            const el = document.createElement('div');
            el.className = 'absolute w-4 h-4 bg-cyan-400 rounded-full border border-white shadow cursor-grab active:cursor-grabbing hover:bg-cyan-300 transition-colors z-10';
            el.style.top = '50%';
            el.style.left = `${pos}%`;
            el.style.transform = 'translate(-50%, -50%)';

            // Drag logic
            let isDragging = false;

            el.addEventListener('mousedown', (e) => {
                isDragging = true;
                document.body.style.userSelect = 'none';
            });

            window.addEventListener('mousemove', (e) => {
                if (!isDragging) return;
                const rect = varContainer.getBoundingClientRect();
                let x = e.clientX - rect.left;
                let percent = (x / rect.width) * 100;
                percent = Math.max(0, Math.min(100, percent));

                points[index] = percent;
                el.style.left = `${percent}%`;
                updateVariance();
            });

            window.addEventListener('mouseup', () => {
                isDragging = false;
                document.body.style.userSelect = '';
            });

            varContainer.appendChild(el);
        }

        function updateVariance() {
            const mean = points.reduce((a, b) => a + b, 0) / points.length;

            // Calculate Variance
            let sumSqDiff = 0;

            // Remove old connector lines
            document.querySelectorAll('.connector-line').forEach(e => e.remove());

            points.forEach((p, i) => {
                const diff = p - mean;
                sumSqDiff += diff * diff;

                // Draw connector line to mean
                const line = document.createElement('div');
                line.className = 'connector-line absolute h-0.5 bg-slate-600/50';
                line.style.top = '50%';
                if (p < mean) {
                    line.style.left = `${p}%`;
                    line.style.width = `${mean - p}%`;
                } else {
                    line.style.left = `${mean}%`;
                    line.style.width = `${p - mean}%`;
                }
                varContainer.insertBefore(line, varContainer.firstChild);
            });

            const variance = sumSqDiff / points.length;
            const stdDev = Math.sqrt(variance);

            // Update UI
            varMeanLine.style.left = `${mean}%`;
            varMeanVal.textContent = (mean / 10).toFixed(1);
            varVal.textContent = (variance / 100).toFixed(1); // Scale down for readability
            stdVal.textContent = (stdDev / 10).toFixed(1);
        }

        initVariance();

    </script>
</body>

</html>